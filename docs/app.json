[{"name":"app.R","content":"################################################################################\r\n# Pediatric Dosing Calculator\r\n# Shiny App developed for use by CRCs in MEDS 3.5 study to aid in identifying\r\n#     pediatric dosing errors (PI Margaret Samuels-Kalow).\r\n# Developed by Melissa Meeker, PhD\r\n################################################################################\r\n\r\n\r\n# Loading Packages\r\nlibrary(shiny)\r\n\r\n# Creating User Interface\r\nui <- fluidPage(\r\n  h1(\"Pediatric Dosing Calculator\"),\r\n  h5(tags$em(\"Intended only for use in MEDS 3.5 study. Always confirm dosing with pharmacist.\")),\r\n\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      numericInput(\"weight\", \"Enter child's weight (kg):\", value = 12, min = 1, max = 150, step = 1),\r\n      selectInput(\"med\", \"Medication:\",\r\n                  choices = c(\"Tylenol (Liquid)\",\r\n                              \"Infant Motrin (Liquid)\",\r\n                              \"Children's Motrin (Liquid)\",\r\n                              \"Tylenol (Suppository)\",\r\n                              \"Motrin (Suppository)\"))\r\n    ),\r\n\r\n    mainPanel(\r\n\r\n      h2(\"Weight\"),\r\n      tags$em(\"Weight only accepted between 0kg and 150kg.\",\r\n              style = \"font-size: 0.9em; color: gray;\"),      br(),\r\n      textOutput(\"display_weight\"),\r\n      br(),\r\n\r\n      h2(\"Recommended Dose\"),\r\n      tags$em(\"Reported as exact dose (20% error range)\",\r\n              style = \"font-size: 0.9em; color: gray;\"),      br(),\r\n\r\n      textOutput(\"liquid\"),\r\n      textOutput(\"supp\")\r\n    )\r\n  )\r\n)\r\n\r\n# Code for calculating dose\r\nserver <- function(input, output) {\r\n\r\n  # Only allows weight input in range (between 1kg and 65kg).\r\n  wt_kg <- reactive({\r\n    w <- as.numeric(input$weight)\r\n\r\n    if(w<0 || w>=150){\r\n      return(NA)  # invalid input → missing\r\n    } else if(w>40){\r\n      return(40)\r\n    } else {\r\n      return(w)   # valid input → use directly\r\n    }\r\n  })\r\n\r\n  # Display weight in kilograms\r\n  output$display_weight <- renderText({\r\n    paste(\"Weight entered:\", as.numeric(input$weight), \"kg\")\r\n  })\r\n\r\n  # Liquid dose calculations\r\n  output$liquid <- renderText({\r\n    wt <- wt_kg()\r\n    med <- input$med\r\n\r\n    if (med == \"Tylenol (Liquid)\") {\r\n\r\n      value_mg = wt*15\r\n\r\n      value_ml = 5*((value_mg)/160)\r\n      lower <- 5*((value_mg-(0.2*value_mg))/160)\r\n      upper <- 5*((value_mg+(0.2*value_mg))/160)\r\n      paste(\"Liquid dose: \", format(round(value_ml, 1), nsmall = 1), \" (\", format(round(lower,1), nsmall = 1), \" to \", format(round(upper,1), nsmall = 1), \") mL\")\r\n    }\r\n    else if (med == \"Infant Motrin (Liquid)\") {\r\n\r\n      value_mg = wt*10\r\n\r\n      value_ml = 1.25*((value_mg))/50\r\n      lower <- 1.25*((value_mg-(0.2*value_mg))/50)\r\n      upper <- 1.25*((value_mg+(0.2*value_mg))/50)\r\n      paste(\"Liquid dose: \", format(round(value_ml, 1), nsmall = 1), \" (\", format(round(lower,1), nsmall = 1), \" to \", format(round(upper,1), nsmall = 1), \") mL\")\r\n\r\n    }\r\n    else if (med == \"Children's Motrin (Liquid)\") {\r\n\r\n      value_mg = wt*10\r\n\r\n      value_ml = 5*((value_mg)/100)\r\n      lower <- 5*((value_mg-(0.2*value_mg))/100)\r\n      upper <- 5*((value_mg+(0.2*value_mg))/100)\r\n      paste(\"Liquid dose: \", format(round(value_ml, 1), nsmall = 1), \" (\", format(round(lower,1), nsmall = 1), \" to \", format(round(upper,1), nsmall = 1), \") mL\")\r\n\r\n    }\r\n    else {\r\n      \"\"\r\n    }\r\n  })\r\n\r\n  # Suppository dose calculations\r\n  output$supp <- renderText({\r\n    med <- input$med\r\n    wt <- wt_kg()\r\n\r\n    if (med == \"Tylenol (Suppository)\") {\r\n      value_mg = wt*15\r\n      lower <- value_mg-(0.2*value_mg)\r\n      upper <- value_mg+(0.2*value_mg)\r\n      paste(\"Suppository dose: \", format(round(value_mg, 1), nsmall = 1), \" (\", format(round(lower,1), nsmall = 1), \" to \", format(round(upper,1), nsmall = 1), \") mg\")\r\n    }\r\n    else if (med == \"Motrin (Suppository)\") {\r\n      value_mg = wt*10\r\n      lower <- value_mg-(0.2*value_mg)\r\n      upper <- value_mg+(0.2*value_mg)\r\n      paste(\"Suppository dose: \", format(round(value_mg, 1), nsmall = 1), \" (\", format(round(lower,1), nsmall = 1), \" to \", format(round(upper,1), nsmall = 1), \") mg\")\r\n    }\r\n    else {\r\n      \"\"\r\n    }\r\n  })\r\n\r\n}\r\n\r\n#Launch Shiny App\r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
